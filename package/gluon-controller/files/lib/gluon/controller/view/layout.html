<%-
	local ubus = require 'ubus'
	local unistd = require 'posix.unistd'
	local util = require 'gluon.util'
	local uci = require('simple-uci').cursor()

	local hostname = 'localhost'
	local remotes = {}

	local iframe_src = ''

	uci:foreach('gluon-controller', 'remote', function(remote)
		remotes[tonumber(remote.index)] = remote
	end)

	http:prepare_content("application/xhtml+xml")
-%>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, user-scalable=no" />

		<title>Gluon Controller</title>

		<link rel="stylesheet" href="/static/controller.css" type="text/css" />
	</head>
	<body data-node-address="<%| http:getenv('SERVER_ADDR') %>">
		<div class="container">
			<div class="sidebar">
				<h1>Gluon-Controller</h1>
				<div class="remotes">
					<% for nodeid, remote in pairs(remotes) do %>
					<div class="remote">
					<h2><%| remote.name %></h2>
						<a href="<%| url({'node', remote.nodeid, 'config'}) %>">Config Mode</a>,
						<a href="<%| url({'node', remote.nodeid, 'status'}) %>">Status Page</a>,
						<a href="<%| url({'node', remote.nodeid, 'map'}) %>">Map</a>,
						<a href="<%| url({'node', remote.nodeid, 'stats'}) %>">Stats</a>,
						<a href="<%| url({'node', remote.nodeid, 'keepitup'}) %>">KeepItUp</a>
					</div>
					<% end %>
				</div>
			</div>
			<div class="content">
				<% renderer.render(content, scope, pkg) %>
			</div>
		</div>

	</body>
</html>
