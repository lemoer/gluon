<%-
	local ubus = require 'ubus'
	local unistd = require 'posix.unistd'
	local util = require 'gluon.util'
	local uci = require('simple-uci').cursor()

	local hostname = 'localhost'
	local remotes = {}

	local iframe_src = ''

	uci:foreach('gluon-controller', 'remote', function(remote)
		remotes[tonumber(remote.index)] = remote
	end)

	function sort_remotes(a, b)
		return a.name < b.name
	end

	table.sort(remotes, sort_remotes)

	http:prepare_content("application/xhtml+xml")
-%>

<h1>List of Nodes</h1>

<div>
	<a href="<%= url({'nodes', 'new2'}) %>">Add New Node</a>
</div>

<table>
	<thead>
		<tr>
			<th>Name</th>
			<th>Actions</th>
		</tr>
	</thead>
	<tbody>
		<% for nodeid, remote in pairs(remotes) do %>
		<tr>
			<td><a href="<%| url({'nodes', remote.nodeid}) %>"><%| remote.name %></a></td>
			<td><a href="<%| url({'nodes', remote.nodeid, 'edit'}) %>">Edit</a>, <a href="#">Delete</a></td>
		</tr>
		<% end %>
	</tbody>
</table>
